<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>VerdeVoyager ‚Äî PBL Demo</title>
<style>
:root{
  --bg:#f6f8f9;
  --card:#ffffff;
  --muted:#6b7280;
  --accent:#16a34a;
  --accent-2:#10b981;
  --glass: rgba(255,255,255,0.6);
  --radius:12px;
  --shadow: 0 6px 20px rgba(17,24,39,0.06);
  font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
}
html,body{height:100%;margin:0;background:var(--bg);color:#0f172a}
.wrap{max-width:980px;margin:28px auto;padding:20px}
header{display:flex;align-items:center;gap:16px}
.logo{
  width:58px;height:58px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2));
  display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:20px;box-shadow:var(--shadow)
}
h1{margin:0;font-size:22px}
p.lead{margin:6px 0 0;color:var(--muted);font-size:14px}
.grid{display:grid;grid-template-columns:1fr 380px;gap:20px;margin-top:18px}
@media(max-width:880px){.grid{grid-template-columns:1fr;}}
.card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px}
.controls .section{margin-bottom:14px}
.picker-row{display:flex;gap:8px;flex-wrap:wrap}
.chip{
  padding:10px 12px;border-radius:999px;border:1px solid #e6eef0;cursor:pointer;
  background:white;display:inline-flex;align-items:center;gap:8px;font-weight:600;font-size:14px;color:#0f172a;
}
.chip.selected{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;border-color:transparent;box-shadow:0 6px 18px rgba(16,185,129,0.12)}
label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
input[type="text"], select, input[type="date"], input[type="number"]{
  width:100%;padding:10px;border-radius:10px;border:1px solid #e6eef0;font-size:14px;background:transparent;
}
.row{display:flex;gap:10px}
.preferences{display:flex;flex-wrap:wrap;gap:8px}
.pre-btn{padding:8px 10px;border-radius:8px;border:1px solid #e8eef0;background:#fbfdfb;cursor:pointer;font-size:13px}
.pre-btn.active{background:#eefdf2;border-color:var(--accent)}
.budget-wrap{display:flex;align-items:center;gap:8px}
.budget-wrap input[type=range]{flex:1}
.btn{
  display:inline-block;padding:12px 16px;border-radius:999px;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;
  border:none;font-weight:700;cursor:pointer;font-size:15px;box-shadow:0 8px 20px rgba(16,185,129,0.12)
}
.btn.ghost{background:transparent;color:var(--accent);border:1px solid #e6f4ea;box-shadow:none}
.result{min-height:220px;position:relative;overflow:hidden}
.loader{
  display:flex;align-items:center;gap:12px;color:var(--muted);font-weight:600;padding:12px 0;
}
.dots{display:inline-block;width:10px;height:10px;border-radius:50%;background:#c7e9d0;animation:dots 1s linear infinite}
.dots:nth-child(2){animation-delay:.12s}
.dots:nth-child(3){animation-delay:.24s}
@keyframes dots{0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)}}
.itinerary h3{margin:8px 0 6px}
.itinerary p{margin:6px 0;color:#0f172a}
.meta{font-size:13px;color:var(--muted);margin-top:8px}
footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center}
small.note{display:block;margin-top:6px;color:var(--muted)}
.top-row{display:flex;justify-content:space-between;align-items:center;gap:12px}
.actions{display:flex;gap:8px}
</style>
</head>
<body>
<div class="wrap">
<header>
  <div class="logo">VV</div>
  <div>
    <h1>VerdeVoyager ‚Äî PBL Demo</h1>
    <p class="lead">Minimal, offline "AI-like" travel planner ‚Äî collects inputs and simulates web-search results for your project.</p>
  </div>
</header>

<div class="grid">
  <!-- LEFT: form -->
  <div class="card controls" aria-labelledby="formTitle">
    <div class="top-row">
      <strong id="formTitle">Plan your eco trip</strong>
    </div>

    <!-- 1. Styles -->
    <div class="section" aria-label="Trip style">
      <label>Choose trip style</label>
      <div class="picker-row" id="stylePicker">
        <div class="chip" data-style="Nature">‚õ∫ Nature</div>
        <div class="chip" data-style="Beach">üèñ Beach</div>
        <div class="chip" data-style="Mountains">üèî Mountains</div>
        <div class="chip" data-style="City">üèô City</div>
        <div class="chip" data-style="Wellness">üßò Wellness</div>
      </div>
    </div>

    <!-- 2. Dates -->
    <div class="section">
      <label>Dates</label>
      <div class="row">
        <input type="date" id="startDate" placeholder="Enter start date" />
        <input type="date" id="endDate" placeholder="End date" />
      </div>
    </div>

    <!-- 3. Area -->
    <div class="section">
      <label>Area / Region (e.g., Dubai, Kerala, Portugal)</label>
      <input type="text" id="area" placeholder="City, region or country" />
    </div>

    <!-- 4. Budget -->
    <div class="section">
      <label>Budget per person (approx)</label>
      <div class="budget-wrap">
        <input type="range" id="budget" min="50" max="5000" value="500" />
        <div style="min-width:86px">
          <input id="budgetInput" type="number" min="50" max="5000" step="10" value="500" style="width:100%;padding:8px;border-radius:8px;border:1px solid #e6eef0"/>
        </div>
      </div>
    </div>

    <!-- 5. Preferences -->
    <div class="section">
      <label>Preferences (select any)</label>
      <div class="preferences" id="prefs">
        <div class="pre-btn" data-pref="public">Use public transport</div>
        <div class="pre-btn" data-pref="vegan">Vegan-friendly</div>
        <div class="pre-btn" data-pref="lowcarbon">Low-carbon stays</div>
        <div class="pre-btn" data-pref="hidden">Hidden gems</div>
        <div class="pre-btn" data-pref="family">Family-friendly</div>
      </div>
    </div>

    <!-- Generate -->
    <div class="section" style="margin-top:6px">
      <div class="actions">
        <button id="generateBtn" class="btn">Generate My Trip</button>
        <button id="clearBtn" class="btn ghost">Clear</button>
        <button id="askGeminiBtn" class="btn">Ask Gemini</button>
      </div>
    </div>
  </div>

  <!-- RIGHT: result -->
  <div class="card result" id="resultCard" aria-live="polite">
    <div id="resultInner" style="padding:6px 2px">
      <div class="loader" id="idleMessage">
        <div style="font-weight:700">Ready to plan</div>
        <div style="color:var(--muted);margin-left:6px">Pick options and click <strong>Generate My Trip</strong></div>
      </div>
      <div id="outputArea" style="display:none">
        <div class="top-row">
          <div>
            <strong id="destTitle">Trip Plan</strong>
            <div class="meta" id="destMeta">‚Äî</div>
          </div>
          <div style="text-align:right">
            <div id="foundWebs" style="font-size:13px;color:var(--muted)"></div>
          </div>
        </div>
        <div class="itinerary" id="itineraryContent" style="margin-top:10px"></div>
        <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
          <button id="downloadBtn" class="btn ghost">Download TXT</button>
          <button id="regenBtn" class="btn">Regenerate</button>
        </div>
      </div>
    </div>
  </div>
</div>

<footer>
  Tip: Save the file as <code>index.html</code> and upload to GitHub Pages for a live demo.
</footer>
</div>

<script>
// -------------------------
// Offline "AI-like" PBL demo
// -------------------------
const stylePicker = document.getElementById('stylePicker');
const chips = stylePicker.querySelectorAll('.chip');
let selectedStyle = 'Nature';
chips.forEach(ch=>{
  if(ch.dataset.style===selectedStyle) ch.classList.add('selected');
  ch.addEventListener('click', ()=> {
    chips.forEach(c=>c.classList.remove('selected'));
    ch.classList.add('selected');
    selectedStyle = ch.dataset.style;
  });
});

// budget sync
const budget = document.getElementById('budget');
const budgetInput = document.getElementById('budgetInput');
budget.addEventListener('input', ()=> budgetInput.value = budget.value);
budgetInput.addEventListener('change', ()=> {
  let v = Number(budgetInput.value);
  if(isNaN(v) || v < 50) v = 50;
  if(v > 5000) v = 5000;
  budget.value = v;
  budgetInput.value = v;
});

// preferences
const prefButtons = document.querySelectorAll('.pre-btn');
const prefsState = {};
prefButtons.forEach(b=>{
  prefsState[b.dataset.pref] = false;
  b.addEventListener('click', ()=>{
    prefsState[b.dataset.pref] = !prefsState[b.dataset.pref];
    b.classList.toggle('active', prefsState[b.dataset.pref]);
  });
});

// UI refs
const generateBtn = document.getElementById('generateBtn');
const clearBtn = document.getElementById('clearBtn');
const regenBtn = document.getElementById('regenBtn');
const downloadBtn = document.getElementById('downloadBtn');
const askGeminiBtn = document.getElementById('askGeminiBtn');

const idleMessage = document.getElementById('idleMessage');
const outputArea = document.getElementById('outputArea');
const destTitle = document.getElementById('destTitle');
const destMeta = document.getElementById('destMeta');
const itineraryContent = document.getElementById('itineraryContent');
const foundWebs = document.getElementById('foundWebs');

// Offline sample data
const SAMPLE = {
  "Nature":[
    {name:"Valley Reserve", desc:"Forest walks, birding, community homestay", eco:"community-run homestay"},
    {name:"Green Lake", desc:"Kayak, wetlands and local guides", eco:"small-group kayak with conservation fee"}
  ],
  "Beach":[
    {name:"Azure Cove", desc:"Clear water, tide pools and coastal cleanups", eco:"beach cleanup + snorkel"},
    {name:"Sandy Point", desc:"Quiet beaches, local seafood markets", eco:"visit marine-protection center"}
  ],
  "Mountains":[
    {name:"Pine Ridge", desc:"Rugged trails, mountain huts", eco:"stay at solar-heated huts"},
    {name:"Highview Pass", desc:"Alpine lakes, guided valley walks", eco:"guided low-impact treks"}
  ],
  "City":[
    {name:"Old Quarter", desc:"Heritage walk, local artisan markets", eco:"support sustainable crafts"},
    {name:"Green Metro", desc:"Cycle-friendly districts & parks", eco:"bike-share tours"}
  ],
  "Wellness":[
    {name:"River Retreat", desc:"Yoga, meditation & organic food", eco:"retreat with composting kitchens"},
    {name:"Holistic Village", desc:"Therapies, herbal gardens", eco:"locally-run wellness programs"}
  ]
};

const FAKE_SOURCES = ["local-guides.org", "greentravel.blog", "eco-tours.example", "travelforchange.net", "visitlocal.gov", "communitystays.com"];

// Functions for offline planner
function computeDays(start,end){
  if(!start || !end) return null;
  const s = new Date(start);
  const e = new Date(end);
  const diff = Math.round((e - s)/(1000*60*60*24)) + 1;
  return isNaN(diff) ? null : diff;
}

function simulateSearchUI(){
  idleMessage.style.display = 'flex';
  outputArea.style.display = 'none';
  idleMessage.innerHTML = `
    <div style="display:flex;flex-direction:column">
      <div style="font-weight:700">üåø VerdeVoyager is planning your trip...</div>
      <div style="font-size:13px;color:var(--muted);margin-top:8px">Searching helpful websites and local guides</div>
    </div>
    <div style="margin-left:auto;display:flex;align-items:center;gap:8px">
      <div class="dots"></div><div class="dots"></div><div class="dots"></div>
    </div>
  `;
}

function pickSample(style, area, budgetVal, prefs){
  const options = SAMPLE[style] || SAMPLE["Nature"];
  let idx = 0;
  if(prefs.includes('hidden')) idx = 1;
  if(budgetVal > 1500) idx = 0;
  const pick = options[idx] || options[0];
  const transport = prefs.includes('public') ? "Public transport (train/bus) + local bike-share" : (budgetVal > 1200 ? "Fast connections (flights + private transfers)" : "Local buses and shared taxis");
  const stay = prefs.includes('lowcarbon') ? "Eco-certified stay or community homestay" : (budgetVal > 1200 ? "Comfortable small eco-hotel" : "Budget guesthouse with local host");
  const food = prefs.includes('vegan') ? "Mostly vegan/plant-based options" : "Local cuisine with healthy choices";
  const activity = pick.eco || "Volunteer/cleanup or guided conservation activity";
  return {
    title: `${pick.name} ‚Äî ${style} near ${area}`,
    destName: pick.name,
    desc: pick.desc,
    eco: activity,
    transport, stay, food,
    confidence: pickConfidence(style, area, budgetVal)
  };
}

function pickConfidence(style, area, budgetVal){
  const found = Math.min(5, 2 + Math.round(Math.random()*4));
  let confidence = "Likely a great fit";
  if(budgetVal < 150) confidence = "Budget-conscious options suggested";
  if(budgetVal > 2000) confidence = "Comfort options available";
  return {found, confidence};
}

function sampleArray(arr, n){
  const out = [];
  const copy = [...arr];
  for(let i=0;i<n;i++){
    if(copy.length===0) break;
    const idx = Math.floor(Math.random()*copy.length);
   
